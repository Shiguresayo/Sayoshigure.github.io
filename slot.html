<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>ã‚¹ãƒ­ãƒƒãƒˆé¢¨ãƒªãƒ¼ãƒ«</title>
<style>
  .reel-container { display:flex; justify-content:center; gap:10px; margin:50px;}
  .reel-wrapper { width:100px; height:100px; overflow:hidden; border:2px solid #333; border-radius:8px;}
  .reel-inner { display:flex; flex-direction:column; }
  .reel-inner img { width:100px; height:100px; }
  #startBtn { display:block; margin:20px auto; padding:10px 20px; font-size:16px; }
  #result { text-align:center; font-size:24px; margin-top:20px; font-weight:bold; }
</style>
</head>
<body>

<div class="reel-container">
  <div class="reel-wrapper"><div class="reel-inner"><img src="pamo1.jpg"><img src="pamo2.jpg"><img src="pamo3.jpg"></div></div>
  <div class="reel-wrapper"><div class="reel-inner"><img src="pamo1.jpg"><img src="pamo2.jpg"><img src="pamo3.jpg"></div></div>
  <div class="reel-wrapper"><div class="reel-inner"><img src="pamo1.jpg"><img src="pamo2.jpg"><img src="pamo3.jpg"></div></div>
</div>

<button id="startBtn">ã‚¹ã‚¿ãƒ¼ãƒˆ</button>
<div id="result"></div>

<script>
const images = ["pamo1.jpg","pamo2.jpg","pamo3.jpg"];
const reelInners = document.querySelectorAll(".reel-inner");
const btn = document.getElementById("startBtn");
const resultDiv = document.getElementById("result");

// å‰å›ä½ç½®(px)ã‚’ä¿æŒ
let positions = [0,0,0];

btn.addEventListener("click", () => {
    btn.disabled = true;
    resultDiv.textContent = "";

    const baseSpeed = 10;  // é«˜é€Ÿå›è»¢(px/frame)
    const stopDelays = [0, 15, 30]; // å·¦â†’å³é †ã«æ¸›é€Ÿé–‹å§‹
    const decelerationFrames = 30; // æ¸›é€ŸæœŸé–“ãƒ•ãƒ¬ãƒ¼ãƒ æ•°

    let frame = 0;
    let speeds = [baseSpeed, baseSpeed, baseSpeed];

    function animate() {
        reelInners.forEach((inner, i) => {
            // æ¸›é€Ÿåˆ¤å®š
            if(frame >= stopDelays[i]){
                const t = Math.min((frame - stopDelays[i])/decelerationFrames,1);
                speeds[i] = baseSpeed * (1 - t*t); // äºŒæ¬¡ã‚¤ãƒ¼ã‚¸ãƒ³ã‚°ã§æ»‘ã‚‰ã‹æ¸›é€Ÿ
            }

            // ç¾åœ¨ä½ç½®æ›´æ–°
            positions[i] += speeds[i];
            positions[i] %= images.length*100; // ãƒ«ãƒ¼ãƒ—
            inner.style.transform = `translateY(-${Math.floor(positions[i])}px)`;
        });

        frame++;

        // æ¸›é€Ÿå®Œäº†å‰ã¯æ¬¡ãƒ•ãƒ¬ãƒ¼ãƒ ã¸
        if(frame < stopDelays[2] + decelerationFrames){
            requestAnimationFrame(animate);
        } else {
            // ãƒ©ãƒ³ãƒ€ãƒ ã§æœ€çµ‚åœæ­¢ä½ç½®
            reelInners.forEach((inner, i) => {
                const finalIndex = Math.floor(Math.random()*images.length);
                positions[i] = finalIndex*100;
                inner.style.transform = `translateY(-${positions[i]}px)`;
            });

            // å½“ãŸã‚Šåˆ¤å®š
            const firstIndex = positions[0]/100;
            const allSame = positions.every(p => p/100 === firstIndex);
            resultDiv.textContent = allSame ? "å½“ãŸã‚Šï¼ğŸ‰" : "ã¯ãšã‚Œâ€¦ğŸ˜¢";

            btn.disabled = false;
        }
    }

    animate();
});
</script>

</body>
</html>
