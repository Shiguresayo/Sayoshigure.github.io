<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>ãƒ‘ãƒ¢ã‚¹ãƒ­ãƒƒãƒˆ</title>
<style>
  .reel-container {
    display: flex;
    justify-content: center;
    gap: 10px;
    margin: 50px;
  }
  .reel {
    width: 100px;
    height: 100px;
  }
  #startBtn {
    display: block;
    margin: 20px auto;
    padding: 10px 20px;
    font-size: 16px;
  }
  #result {
    text-align: center;
    font-size: 24px;
    margin-top: 20px;
    font-weight: bold;
  }
</style>
</head>
<body>

<div class="reel-container">
  <img class="reel" src="pamo1.jpg" alt="ãƒªãƒ¼ãƒ«1">
  <img class="reel" src="pamo1.jpg" alt="ãƒªãƒ¼ãƒ«2">
  <img class="reel" src="pamo1.jpg" alt="ãƒªãƒ¼ãƒ«3">
</div>
<button id="startBtn">ã‚¹ã‚¿ãƒ¼ãƒˆ</button>
<div id="result"></div>

<script>
const images = ["pamo1.jpg", "pamo2.jpg", "pamo3.jpg"];
const reels = document.querySelectorAll(".reel");
const btn = document.getElementById("startBtn");
const resultDiv = document.getElementById("result");

btn.addEventListener("click", () => {
    btn.disabled = true; 
    resultDiv.textContent = ""; 

    const interval = 100; 
    const totalSpins = 30; 
    const stopDelays = [0, 5, 10]; 
    let count = 0;

    // å›è»¢ä¸­ã¯ä¸€å®šé€Ÿåº¦
    const reelInterval = setInterval(() => {
        reels.forEach((reel, i) => {
            if(count < totalSpins + stopDelays[i]){
                const cycleIndex = (count + i) % images.length;
                reel.src = images[cycleIndex];
            }
        });
        count++;
        if(count >= totalSpins + stopDelays[reels.length -1]){
            clearInterval(reelInterval);
            // æ¸›é€Ÿåœæ­¢æ¼”å‡ºã‚’é †ç•ªã«é–‹å§‹
            reels.forEach((reel, i) => slowStop(reel, i));
        }
    }, interval);

    // æ¸›é€Ÿåœæ­¢ç”¨é–¢æ•°
    function slowStop(reel, reelIndex){
        let delay = 50; // æœ€åˆã®é–“éš”
        const steps = 5; // æ¸›é€Ÿæ®µéš
        let step = 0;

        function stepRotation(){
            if(step < steps){
                const nextIndex = (Math.floor(Math.random()*images.length));
                reel.src = images[nextIndex];
                delay += 50; // å¾ã€…ã«é–“éš”ã‚’é•·ã
                step++;
                setTimeout(stepRotation, delay);
            } else {
                // æœ€å¾Œã«æ­¢ã‚ã‚‹ç”»åƒã‚’æ±ºå®š
                const finalIndex = Math.floor(Math.random() * images.length);
                reel.src = images[finalIndex];

                // å…¨éƒ¨æ­¢ã¾ã£ãŸã‚‰å½“ãŸã‚Šåˆ¤å®š
                if(reelIndex === reels.length -1){
                    const first = reels[0].src.split('/').pop();
                    const allSame = Array.from(reels).every(r => r.src.includes(first));
                    resultDiv.textContent = allSame ? "å½“ãŸã‚Šï¼ğŸ‰" : "ã¯ãšã‚Œâ€¦ğŸ˜¢";
                    btn.disabled = false;
                }
            }
        }
        // ãƒªãƒ¼ãƒ«ã”ã¨ã«å°‘ã—é…ã‚‰ã›ã¦é †ç•ªã«æ¸›é€Ÿ
        setTimeout(stepRotation, reelIndex * 200);
    }
});
</script>

</body>
</html>
